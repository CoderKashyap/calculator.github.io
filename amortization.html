<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amortization Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        body {
            font-family: "Montserrat", sans-serif;
            font-optical-sizing: auto;
            font-style: normal;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            box-sizing: border-box;
            background: #f4f4f4;
        }

        .headPara {
            font-weight: 500;
        }

        .calculator-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            background-color: white;
            border: 1px solid rgb(206, 206, 206);
            border-radius: 20px;
            max-width: 1060px;

            margin: 2rem auto;
        }

        .input-section-container,
        .result-section {
            min-width: 45%;
        }

        .result-section {
            display: flex;
            align-items: center;
            justify-content: center;
        }


        .input-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: rgb(80, 80, 80);
        }

        input,
        select {
            width: 100%;
            font-size: 1.2em;
            padding: 8px;
            border: 2px solid #d1d1d1;
            border-radius: 8px;
            box-sizing: border-box;
            outline-color: rgb(219, 128, 54);
            color: rgb(80, 80, 80);
        }

        .down-payment-group {
            display: flex;
            gap: 10px;
        }

        .down-payment-group select {
            width: 60px;
        }

        .down-payment-group input {
            flex-grow: 1;
        }

        .info-text {
            font-size: 0.8em;
            color: #666;
            margin-top: 5px;
        }

        .calculate-btn {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 1.4em;
        }

        .calculate-btn:hover {
            background-color: #0056b3;
        }

        .result-card {
            /* background-color: #2D1B69; */
            background: linear-gradient(90deg, #FF512F 0%, #c35b0b 100%);
            color: white;
            padding: 20px;
            border-radius: 20px;
        }

        .input-section-container {
            padding: 10px;
            border-radius: 20px;
        }

        .estimated-payment {
            font-size: 2.5em;
            font-weight: bold;
            margin: 20px 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .payment-breakdown {
            display: flex;
            justify-content: space-between;
            gap: .6rem;
            margin-bottom: 20px;
        }

        .YouMightAlsoLike {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .YouMightAlsoLikeCont .YouMightAlsoLikeTitle {
            text-align: center;
            font-weight: 500;
            margin: 1rem;
        }

        .YouMightAlsoLikeCont {
            margin: 2rem 0;
        }

        .calculatorCards {
            border: 1px solid rgb(206, 206, 206);
            background: #fff;
            border-radius: 20px;
            padding: 1rem 2rem;

            text-align: center;
            font-size: .875rem;
            color: #222;
            text-decoration: none;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            cursor: pointer;

            max-width: 15rem;
        }

        .calculatorCards:hover {
            border: 1px solid rgb(113, 113, 113);
        }

        .payment-item {
            /* background-color: #3D2B79; */
            background-color: #b11212;
            padding: 10px;
            border-radius: 4px;
            flex: 1;
            margin: 0 5px;
            text-align: center;
        }

        .payment-item-label {
            font-size: 0.8em;
            margin-bottom: 5px;
        }

        .ctaDiv {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .get-real-numbers-btn {
            /* background-color: #B11212; */
            /* background-color: #F09819; */
            background: linear-gradient(90deg, #FF512F 0%, #F09819 100%);
            color: white;
            border: none;
            font-weight: bold;
            padding: 12px 22px;
            border-radius: 20px;
            cursor: pointer;
            margin: 1.4rem;
            font-size: 1.2em;
            transition: transform 0.3s ease;
            box-shadow: 0px 0px 2px 0px #e6e6e6;
        }

        .get-real-numbers-btn:hover {
            transform: scale(1.1);
        }


        .get-advice-btn {
            background-color: transparent;
            color: white;
            border: 1px solid white;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1.2em;
            margin-top: 10px;
            font-weight: bold;
        }

        .get-advice-btn:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }


        .summary-title {
            text-align: center;
            font-size: 24px;
            color: #FF512F;
            margin-bottom: 20px;
        }

        .amortization-text {
            font-size: 18px;
            color: #333;
            margin-bottom: 20px;
        }

        .summary-list {
            font-size: 16px;
            line-height: 1.8;
            color: #555;
            padding-left: 20px;
        }

        .summary-list li {
            margin-bottom: 10px;
        }

        .errorStyle {
            display: none;
            color: red;
            background: rgb(255, 215, 215);
            border: 1px solid rgb(255, 170, 170);
            border-radius: 14px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .calculation-description-container {
            padding: 1rem;
            background-color: white;
            border: 1px solid rgb(206, 206, 206);
            border-radius: 20px;

            max-width: 900px;
            margin: 20px auto;
        }

        .ComponentBody {
            margin: 2rem 0;
            padding: 1rem;
        }

        .ComponentBody h1 {
            font-size: 1.8rem;
        }

        @media (max-width: 768px) {
            .calculator-container {
                padding: 6px;
                margin: 1rem 0;
            }

            .result-card {
                padding: 1rem;
            }

            .ComponentBody {
                padding: 10px;
            }

            .payment-item {
                text-align: left;
            }

            .payment-breakdown {
                flex-direction: column;
            }

        }


        /* ----------------------------------------------- */
        .graphContainer {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0;
        }

        .card {
            background-color: white;
            border-radius: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            width: 100%;
            max-width: 800px;
        }

        .card-header {
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 24px;
            font-weight: bold;
            margin: 0 0 10px 0;
        }

        .card-description {
            font-size: 14px;
            color: #666;
        }

        #chart-container {
            height: 400px;
        }

        /* ... (keep existing styles) ... */

        /* Add styles for the amortization schedule table */
        #amortizationSchedule {
            width: 100%;
            border-collapse: collapse;
            margin: 2rem 0;
            overflow: auto
        }

        #amortizationSchedule th,
        #amortizationSchedule td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: right;
        }

        #amortizationSchedule th {
            background-color: #f2f2f2;
            font-weight: bold;
        }

        #amortizationSchedule tr:nth-child(even) {
            background-color: #f9f9f9;
        }

        #amortizationSchedule tr:hover {
            background-color: #f5f5f5;
        }

        /* Hide graph and table initially */
        #chart-container,
        #amortizationSchedule,
        #graph-container {
            display: none;
        }





        /* ----------------------------------- */
    </style>
</head>

<body>
    <div class="ComponentBody">

        <div class="headingParaBox">
            <h1>Amortization Calculator</h1>
            <p class="headPara">Estimate your monthly mortgage payment and view an amortization schedule.</p>
        </div>

        <div id="errorMessage" class="errorStyle"></div>

        <div class="calculator-container">
            <div class="input-section-container">
                <!-- Input for Home Price -->
                <div class="input-group">
                    <label for="startingPrice">Home Price</label>
                    <input type="text" id="startingPrice" placeholder="$0">
                </div>

                <!-- Input for Down Payment -->
                <div class="input-group">
                    <label for="downPayment">Down Payment</label>
                    <div class="down-payment-group">
                        <select id="downPaymentType">
                            <option value="$">$</option>
                            <option value="%">%</option>
                        </select>
                        <input type="text" id="downPayment" placeholder="0">
                    </div>
                    <p class="info-text">An average down payment is about 5% of the home price.</p>
                </div>

                <!-- Input for Loan Term -->
                <div class="input-group">
                    <label for="amortizationPeriod">Amortization Period (Years)</label>
                    <select id="amortizationPeriod">
                        <option value="">Select Term</option>
                        <option value="5">5 years</option>
                        <option value="10">10 years</option>
                        <option value="15">15 years</option>
                        <option value="20">20 years</option>
                        <option value="25">25 years</option>
                        <option value="30">30 years</option>
                    </select>
                </div>

                <!-- Input for Interest Rate -->
                <div class="input-group">
                    <label for="interestRate">Interest Rate (%)</label>
                    <input type="number" id="interestRate" value="6.5" step="0.1">
                </div>

                <!-- Calculate Button -->
                <!-- <button class="calculate-btn" onclick="calculateMortgage()">Calculate</button> -->
            </div>

            <!-- ... (keep existing result section) ... -->
            <div class="result-section">

                <div class="result-card">
                    <h2>Estimated Monthly Payment</h2>
                    <div class="estimated-payment" id="monthlyPayment">$--</div>
                    <div class="payment-breakdown">
                        <div class="payment-item">
                            <div class="payment-item-label">INSTALLMENTS</div>
                            <div id="installments">--</div>
                        </div>
                        <div class="payment-item">
                            <div class="payment-item-label">INTEREST</div>
                            <div id="totalInterest">$--</div>
                        </div>
                        <div class="payment-item">
                            <div class="payment-item-label">MORTGAGE</div>
                            <div id="totalMortgage">$--</div>
                        </div>
                    </div>
                    <p>Apply now to get your actual numbers without affecting your credit.</p>


                    <div class="ctaDiv">
                        <button class="get-real-numbers-btn">Apply Now </button>
                    </div>

                    <div class="ctaDiv">
                        <button class="get-advice-btn">Get Expert Advice</button>
                    </div>

                </div>
            </div>

        </div>

        


        <div class="graphContainer" id="graph-container">
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">Amortization Schedule</h2>
                    <p class="card-description">Monthly payments over the loan term</p>
                </div>
                <div id="chart-containe">
                    <canvas id="amortizationChart"></canvas>
                </div>
            </div>
        </div>

        <div id="amortizationSchedule" class="graphContainer"></div>



        
        <div class="YouMightAlsoLikeCont">

            <p class="YouMightAlsoLikeTitle">You Might Also Like</p>

            <div class="YouMightAlsoLike">

                <a href="./amortization.html" class="calculatorCards">
                    <img src="https://prod.rockmedialibrary.com/api/public/content/affordability-pictogram?v=c2a90fe4"
                        alt="calculator icon">
                    <h3>Amortization Calculator</h3>
                </a>
                <a href="#" class="calculatorCards">
                    <img src="https://prod.rockmedialibrary.com/api/public/content/affordability-pictogram?v=c2a90fe4"
                        alt="calculator icon">
                    <h3>Down-Payment Calculator</h3>
                </a>
                <a href="#" class="calculatorCards">
                    <img src="https://prod.rockmedialibrary.com/api/public/content/affordability-pictogram?v=c2a90fe4"
                        alt="calculator icon">
                    <h3>Refinance Calculator</h3>
                </a>

            </div>

        </div>





        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>




        <script>

            const startingPriceInput = document.getElementById('startingPrice');
            const downPaymentInput = document.getElementById('downPayment');
            const downPaymentTypeInput = document.getElementById('downPaymentType');
            const interestRateInput = document.getElementById('interestRate');
            const amortizationPeriodInput = document.getElementById('amortizationPeriod');
            const monthlyPaymentEl = document.getElementById('monthlyPayment');
            const totalMortgageEl = document.getElementById('totalMortgage');
            const totalInterestEl = document.getElementById('totalInterest');
            const totalInstallmentsEl = document.getElementById('installments');
            const amortizationScheduleEl = document.getElementById('amortizationSchedule');
            const errorMessageEl = document.getElementById('errorMessage');
            // ... (keep existing variable declarations) ...

            function formatCurrency(value) {
                value = value.replace(/[^\d.]/g, '');
                const parts = value.split('.');
                if (parts.length > 1) {
                    parts[1] = parts[1].slice(0, 2);
                    value = parts.join('.');
                }
                value = value.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                return value;
            }

            function handleCurrencyInput(input) {
                const cursorPosition = input.selectionStart;
                const oldLength = input.value.length;
                input.value = formatCurrency(input.value);
                const newLength = input.value.length;
                input.setSelectionRange(cursorPosition + (newLength - oldLength), cursorPosition + (newLength - oldLength));
            }


            startingPriceInput.addEventListener('input', () => {
                handleCurrencyInput(startingPriceInput);
                calculateMortgage();
            });
            downPaymentInput.addEventListener('input', () => {
                handleCurrencyInput(downPaymentInput);
                calculateMortgage();
            });
            downPaymentTypeInput.addEventListener('change', calculateMortgage);
            interestRateInput.addEventListener('input', calculateMortgage);
            amortizationPeriodInput.addEventListener('change', calculateMortgage);



            function calculateMortgage() {
                const startingPrice = parseFloat(startingPriceInput.value.replace(/[^\d.]/g, ''));
                let downPayment = parseFloat(downPaymentInput.value.replace(/[^\d.]/g, ''));
                const downPaymentType = downPaymentTypeInput.value;
                const annualInterestRate = parseFloat(interestRateInput.value) / 100;
                const amortizationPeriod = parseInt(amortizationPeriodInput.value);

                if (!startingPrice || !downPayment || !annualInterestRate || !amortizationPeriod) {
                    hideResults();
                    return;
                }

                if (downPaymentType === "%") {
                    downPayment = (downPayment / 100) * startingPrice;
                }

                const mortgageAmount = startingPrice - downPayment;
                const monthlyInterestRate = annualInterestRate / 12;
                const numberOfPayments = amortizationPeriod * 12;

                const monthlyPayment = (mortgageAmount * monthlyInterestRate) / (1 - Math.pow(1 + monthlyInterestRate, -numberOfPayments));
                const totalInterest = (monthlyPayment * numberOfPayments) - mortgageAmount;

                monthlyPaymentEl.textContent = `$${monthlyPayment.toFixed(2)}`;
                totalMortgageEl.textContent = `$${mortgageAmount.toFixed(2)}`;
                totalInterestEl.textContent = `$${totalInterest.toFixed(2)}`;
                totalInstallmentsEl.textContent = `${numberOfPayments.toFixed(0)}`;

                createAmortizationSchedule(mortgageAmount, monthlyInterestRate, monthlyPayment, numberOfPayments);
                createChart(mortgageAmount, monthlyInterestRate, monthlyPayment, numberOfPayments);
                showResults();
            }


            function createAmortizationSchedule(principal, monthlyInterestRate, monthlyPayment, numberOfPayments) {
                let balance = principal;
                let totalCapital = 0;
                let totalInterests = 0;
                let schedule = `
    <div class="table-responsive">
        <table class="amortization-table">
            <thead>
                <tr>
                    <th>Month</th>
                    <th>Principal Balance</th>
                    <th>Capital Paid</th>
                    <th>Total Capital</th>
                    <th>Interests Paid</th>
                    <th>Total Interests</th>
                </tr>
            </thead>
            <tbody>`;

                // Add initial row with starting balance
                schedule += `
                <tr>
                    <td data-label="Month">0</td>
                    <td data-label="Principal Balance">$${balance.toFixed(2)}</td>
                    <td data-label="Capital Paid">$0.00</td>
                    <td data-label="Total Capital">$0.00</td>
                    <td data-label="Interests Paid">$0.00</td>
                    <td data-label="Total Interests">$0.00</td>
                </tr>`;

                for (let i = 1; i <= numberOfPayments; i++) {
                    const interestPayment = balance * monthlyInterestRate;
                    let principalPayment = monthlyPayment - interestPayment;

                    // Adjust the last payment to not exceed the remaining balance
                    if (balance - principalPayment < 0) {
                        principalPayment = balance;
                        balance = 0;
                    } else {
                        balance -= principalPayment;
                    }

                    totalCapital += principalPayment;
                    totalInterests += interestPayment;

                    schedule += `
                <tr>
                    <td data-label="Month">${i}</td>
                    <td data-label="Principal Balance">$${balance.toFixed(2)}</td>
                    <td data-label="Capital Paid">$${principalPayment.toFixed(2)}</td>
                    <td data-label="Total Capital">$${totalCapital.toFixed(2)}</td>
                    <td data-label="Interests Paid">$${interestPayment.toFixed(2)}</td>
                    <td data-label="Total Interests">$${totalInterests.toFixed(2)}</td>
                </tr>`;

                    // Add year separator after each 12-month cycle
                    if (i % 12 === 0) {
                        schedule += `
                <tr class="year-separator">
                    <td colspan="6"> <strong> Year ${i / 12} </strong> </td>
                </tr>`;
                    }

                    // Break the loop if the balance is zero
                    if (balance === 0) {
                        break;
                    }
                }

                schedule += `
            </tbody>
        </table>
    </div>`;
                amortizationScheduleEl.innerHTML = schedule;
            }


            function createChart(principal, monthlyInterestRate, monthlyPayment, numberOfPayments) {
                let balance = principal;
                let totalCapital = 0;
                let totalInterests = 0;
                const data = [];

                for (let month = 1; month <= numberOfPayments; month++) {
                    const interestPayment = balance * monthlyInterestRate;
                    const principalPayment = monthlyPayment - interestPayment;
                    balance -= principalPayment;
                    totalCapital += principalPayment;
                    totalInterests += interestPayment;

                    data.push({
                        month,
                        principalBalance: balance,
                        totalCapital,
                        totalInterests
                    });
                }

                const ctx = document.getElementById('amortizationChart').getContext('2d');
                if (window.myChart) {
                    window.myChart.destroy();
                }

                // Calculate the maximum value for the y-axis
                const maxValue = Math.max(principal, ...data.map(d => Math.max(d.principalBalance, d.totalCapital, d.totalInterests)));

                window.myChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: data.map(d => d.month),
                        datasets: [
                            {
                                label: 'Principal Balance',
                                data: data.map(d => d.principalBalance),
                                borderColor: 'rgb(75, 192, 192)',
                                tension: 0.1
                            },
                            {
                                label: 'Total Capital',
                                data: data.map(d => d.totalCapital),
                                borderColor: 'rgb(255, 99, 132)',
                                tension: 0.1
                            },
                            {
                                label: 'Total Interests',
                                data: data.map(d => d.totalInterests),
                                borderColor: 'rgb(54, 162, 235)',
                                tension: 0.1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                title: {
                                    display: true,
                                    text: 'Month'
                                }
                            },
                            y: {
                                title: {
                                    display: true,
                                    text: 'Amount ($)'
                                },
                                beginAtZero: true,
                                suggestedMax: maxValue * 1.1, // Add 10% padding to the top
                                ticks: {
                                    callback: function (value, index, values) {
                                        return '$' + value.toLocaleString();
                                    }
                                }
                            }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function (context) {
                                        let label = context.dataset.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed.y !== null) {
                                            label += new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(context.parsed.y);
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
            }


            function showResults() {
                document.getElementById('graph-container').style.display = 'flex';
                document.getElementById('amortizationSchedule').style.display = 'flex';
            }

            function hideResults() {
                document.getElementById('graph-container').style.display = 'none';
                document.getElementById('amortizationSchedule').style.display = 'none';
            }

            function showError(message) {
                errorMessageEl.textContent = message;
                errorMessageEl.style.display = 'block';
            }

            function hideError() {
                errorMessageEl.style.display = 'none';
            }
        </script>


    </div>
</body>

</html>